<%- include('../layout') %>
<style>
@media print {
  .no-print { display: none !important; }
  body { background: #fff !important; }
}
.invoice-box {
  max-width: 700px;
  margin: auto;
  padding: 30px;
  border: 1px solid #eee;
  background: #fff;
  direction: rtl;
  font-family: 'Cairo', Tahoma, Arial, sans-serif;
}
.invoice-header {
  text-align: center;
  margin-bottom: 20px;
}
.invoice-header img {
  max-height: 60px;
  margin-bottom: 10px;
}
.invoice-table th, .invoice-table td {
  text-align: center;
  vertical-align: middle;
}
</style>
<div class="invoice-box shadow">
  <div class="invoice-header">
    <img src="/logo.png" alt="ุดุนุงุฑ ุงููุญู" onerror="this.style.display='none'">
    <h3 class="mb-1">ููุงููุฑ ููุญู ูุณุชุญุถุฑุงุช ุชุฌููู</h3>
    <div>ุงูุนููุงู: ุดุงุฑุน ุงูุฌูุงูุ ุงููุงูุฑุฉ</div>
    <div>ุงููุงุชู: 01000000000</div>
  </div>
  <div class="row mb-3">
    <div class="col-6"><strong>ุฑูู ุงููุงุชูุฑุฉ:</strong> <%= sale._id.toString().slice(-6) %></div>
    <div class="col-6 text-end"><strong>ุงูุชุงุฑูุฎ:</strong> <%= sale.createdAt ? sale.createdAt.toLocaleDateString('ar-EG') : '-' %></div>
  </div>
  <div class="row mb-3">
    <div class="col-6"><strong>ุงุณู ุงูุนููู:</strong> <%= sale.customerName || '-' %></div>
    <div class="col-6 text-end"><strong>ุงูุฌูุณูุฉ:</strong> <%= sale.customerNationality || '-' %></div>
  </div>
  <table class="table table-bordered invoice-table">
    <thead class="table-light">
      <tr>
        <th>ุงูููุน</th>
        <th>ุงูุงุณู</th>
        <th>ุงููููุฉ</th>
        <th>ุงูุณุนุฑ</th>
        <th>ุงูุฅุฌูุงูู</th>
      </tr>
    </thead>
    <tbody>
      <% sale.items.forEach(item => { %>
        <tr>
          <td><%= item.type === 'product' ? 'ููุชุฌ' : 'ุฎุฏูุฉ' %></td>
          <td><%= item.name %></td>
          <td><%= item.quantity %></td>
          <td><%= item.price %> ุฌููู</td>
          <td><%= item.price * item.quantity %> ุฌููู</td>
        </tr>
      <% }) %>
    </tbody>
  </table>
  <div class="row mb-2">
    <div class="col-6"><strong>ุงุณู ุงููุงุดูุฑ:</strong> <%= sale.cashierName %></div>
    <div class="col-6 text-end"><strong>ุงูุฅุฌูุงูู ุงูููู:</strong> <span class="fs-5 text-success"><%= sale.totalPrice %> ุฌููู</span></div>
  </div>
  <div class="text-center mt-4">
    <button class="btn btn-primary no-print" onclick="window.print()">๐จ ุทุจุงุนุฉ</button>
    <a href="/sales/new" class="btn btn-secondary no-print">ูุงุชูุฑุฉ ุฌุฏูุฏุฉ</a>
    <a href="/cashier" class="btn btn-outline-secondary no-print">ุฑุฌูุน</a>
  </div>
</div>
